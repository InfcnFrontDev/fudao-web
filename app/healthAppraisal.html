<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
  <link rel="stylesheet" href="./css/global.css">
  <script src="js/privatejs/main.js"></script>
  <script src="js/jquery.min.js"></script>
  <script src="js/config.js"></script>

</head>
<body>
  <div class="appraisalBox">
    <div  style="margin:10px auto;width:220px;height:220px;display:flex;justify-content:center;position:relative">
      <div id="div_img" style="display:none;">
        <img src="images/load_fudaozhishu.gif" width="220" height="220" style="position:absolute;top:0;left:0; z-index: 0;" />
      </div>
      <div id="div_svg" >
        <svg width="220" height="220" class="pt-ab pt1">
          <circle  cx="110" cy="110" r="70" stroke-width="5" stroke="#C9CACA" fill="none"></circle>
          <circle  cx="110" cy="110" r="70" stroke-width="5" stroke="#00cccc" fill="none" id="svg_zhengzhuang" transform="matrix(0,-1,1,0,0,220)" ></circle>
        </svg>
        <svg width="220" height="220" class="pt-ab pt2">
          <circle  cx="110" cy="110" r="80" stroke-width="5" stroke="#C9CACA" fill="none"></circle>
          <circle  cx="110" cy="110" r="80" stroke-width="5" stroke="#66cc00" fill="none" id="svg_xinli" transform="matrix(0,-1,1,0,0,220)" ></circle>
        </svg>
        <svg width="220" height="220" class="pt-ab pt3">
          <circle  cx="110" cy="110" r="90" stroke-width="5" stroke="#C9CACA" fill="none"></circle>
          <circle  cx="110" cy="110" r="90" stroke-width="5" stroke="#cc9900" fill="none" id="svg_shehui" transform="matrix(0,-1,1,0,0,220)" ></circle>
        </svg>
        <svg width="220" height="220" class="pt-ab pt4">
          <circle  cx="110" cy="110" r="100" stroke-width="5" stroke="#C9CACA" fill="none"></circle>
          <circle  cx="110" cy="110" r="100" stroke-width="5" stroke="#ff9900" fill="none" id="svg_zice" transform="matrix(0,-1,1,0,0,220)" ></circle>
        </svg>
      </div>

      <div style="position:absolute;width:100px; height:100px; top:50px; left:60px;">
        <p class="fdzs">福道指数</p>
        <div class="img_div">
          <img src="images/tou.png" style="height:80px"/>
        </div>
      </div>
    </div>
    <div class="appraisalMark">
      <a class="appraisalBtn" >
        一键测评
      </a>
      <h5 style="display:none;">您的健康水平为良好哦，再接在厉</h5>
      <p style="display:none;">生理健康指数：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="physiology">56</span></p>
      <p style="display:none;">心理健康指数：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="mentality">76</span></p>
      <p style="display:none;">社会健康指数：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="society">56</span></p>
      <p style="display:none;">自测健康指数：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oneself">66</span></p>
    </div>
  
  </div>



  <script>
    //http://localhost:3000/healthAppraisal.html?result=64.6962555436&shehuiSocre=30.9627&xinliSocre=78.4536&zhengzhuangSocre=86.8331&ziceSocre=48.4512&userId=867200022156895,86720002215690328312757
      var result=getQueryString('result');
      var userid=getQueryString('userId');
      //alert(localStorage.getItem(userid));
      $('.appraisalBtn').click(function(){
        location.href="assessmentTest.html?userid="+userid;
      })
      if(result == null){
        if(localStorage.getItem(userid)==null){
          var str='<img src="images/tou.png" style="height:80px"/>'
          $(".img_div").html(str);
        }else{
          $(".img_div").html(localStorage.getItem(userid).split(',')[0]);
          appraisal_init(localStorage.getItem(userid).split(',')[1],localStorage.getItem(userid).split(',')[2],localStorage.getItem(userid).split(',')[3],localStorage.getItem(userid).split(',')[4]);
        }

      }else{
          $(".img_div").html(parseInt(result));
          $("#div_svg").hide()
          $("#div_img").show()
          setTimeout(function(){
              $("#div_svg").show()
              $("#div_img").hide()
          },2000)
          var shehuiSocre=getQueryString('shehuiSocre');
          var xinliSocre=getQueryString('xinliSocre');
          var zhengzhuangSocre=getQueryString('zhengzhuangSocre');
          var ziceSocre=getQueryString('ziceSocre');
          appraisal_init(shehuiSocre,xinliSocre,zhengzhuangSocre,ziceSocre);
        $('.appraisalBtn').hide();
        $('.appraisalMark p').show();
        $('.appraisalMark h5').show();
        $('.physiology').html(parseInt(shehuiSocre));
        $('.mentality').html(parseInt(xinliSocre));
        $('.society').html(parseInt(zhengzhuangSocre));
        $('.oneself').html(parseInt(ziceSocre));
        var arr=[parseInt(result),parseInt(shehuiSocre),parseInt(xinliSocre),parseInt(zhengzhuangSocre),parseInt(ziceSocre)]
        localStorage.setItem(userid,arr);

      }
      function appraisal_init(a,b,c,d){
          var userInformation = {
              'zhengzhuangSocre':a,
              'xinliSocre':b,
              'shehuiSocre':c,
              'ziceSocre':d
          }
          //document.getElementById('countSocre').innerHTML=userInformation.countSocre;
          var svg1 = document.getElementById("svg_zhengzhuang");
          var svg2 = document.getElementById("svg_xinli");
          var svg3 = document.getElementById("svg_shehui");
          var svg4 = document.getElementById("svg_zice");
          var percent1 = Math.round(parseFloat(userInformation.zhengzhuangSocre)) / 100,
              perimeter1 = Math.PI * 2 * 60;
          var percent2 = Math.round(parseFloat(userInformation.xinliSocre)) / 100,
              perimeter2 = Math.PI * 2 * 70;
          var percent3 = Math.round(parseFloat(userInformation.shehuiSocre)) / 100,
              perimeter3 = Math.PI * 2 * 80;
          var percent4 = Math.round(parseFloat(userInformation.ziceSocre)) / 100,
              perimeter4 = Math.PI * 2 * 90;
          svg1.setAttribute('stroke-dasharray', perimeter1 * percent1 + " " + perimeter1 * (1 - percent1));
          svg2.setAttribute('stroke-dasharray', perimeter2 * percent2 + " " + perimeter2 * (1 - percent2));
          svg3.setAttribute('stroke-dasharray', perimeter3 * percent3 + " " + perimeter3 * (1 - percent3));
          svg4.setAttribute('stroke-dasharray', perimeter4 * percent4 + " " + perimeter4 * (1 - percent4));


      }

  </script>

</body>
</html>